
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Using the OPSIN API in Python &#8212; IUPAC FAIR Chemistry Cookbook</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PubChem PUG-REST API" href="pubchem-pug.html" />
    <link rel="prev" title="Accessing the IUPAC Gold Book API in Python" href="goldbook.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/iupac_and_wf.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">IUPAC FAIR Chemistry Cookbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the IUPAC FAIR Chemistry Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  SAMPLE RECIPES
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../sampler.html">
   Sampler Edition - we need your input!
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="uvvis_metadata.html">
     Structured UV/Vis (meta)data for small molecule characterisation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="goldbook.html">
     Accessing the IUPAC Gold Book API in Python
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Using the OPSIN API in Python
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="pubchem-pug.html">
     PubChem PUG-REST API
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="pubchem-pug-rest1.html">
       Accessing PubChem through PUG-REST - Part I
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="pubchem-pug-rest2.html">
       Accessing PubChem through PUG-REST: Part II
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="pubchem-pug-rest3.html">
       Accessing PubChem through PUG-REST: Part III
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="computing_inchis.html">
     Computing InChIs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dataset_search.html">
     Finding a Findable Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="PrepChemicalDataforSharing.html">
     Preparing Chemical Data for FAIR Sharing - A Minimalist Approach
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="learn_spectra.html">
     FAIR formating of (multi, hyper)spectral data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  FUTURE CONTENTS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../school.html">
   CULINARY SCHOOL: FAIR basics for Chemistry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ingredients.html">
   INGREDIENTS: Data standards and formats for Chemistry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../recipes.html">
   RECIPES: Workflows for machine-readable chemical data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../kitchen.html">
   TEST KITCHEN: Checking your chemical data/metadata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pantry.html">
   PANTRY: Finding and sharing FAIR chemical data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cookware.html">
   COOKWARE: Tools for enabling FAIR chemical data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../menus.html">
   MENUS: Use cases for FAIR chemical data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  REFERENCE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../about.html">
   About this Project
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/IUPAC/WFChemCookbook/main?urlpath=tree/book/samples/opsin.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/IUPAC/WFChemCookbook/blob/main/book/samples/opsin.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/IUPAC/WFChemCookbook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/IUPAC/WFChemCookbook/issues/new?title=Issue%20on%20page%20%2Fsamples/opsin.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/samples/opsin.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about-opsin">
   About OPSIN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-1-import-the-python-packages">
   Step 1: Import the Python packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-2-call-the-opsin-data-api">
   Step 2: Call the OPSIN data API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-3-call-the-opsin-image-api">
   Step 3: Call the OPSIN image API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-4-extract-the-formula-of-the-substance">
   Step 4: Extract the formula of the substance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-5-try-other-queries">
   Step 5: Try other queries
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Using the OPSIN API in Python</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about-opsin">
   About OPSIN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-1-import-the-python-packages">
   Step 1: Import the Python packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-2-call-the-opsin-data-api">
   Step 2: Call the OPSIN data API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-3-call-the-opsin-image-api">
   Step 3: Call the OPSIN image API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-4-extract-the-formula-of-the-substance">
   Step 4: Extract the formula of the substance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-5-try-other-queries">
   Step 5: Try other queries
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="using-the-opsin-api-in-python">
<h1>Using the OPSIN API in Python<a class="headerlink" href="#using-the-opsin-api-in-python" title="Permalink to this headline">#</a></h1>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
About this interactive <img alt="icons" src="../_images/rocket.png" /> recipe<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Author: <a class="reference external" href="https://orcid.org/0000-0002-0703-7776">Stuart Chalk</a></p></li>
<li><p class="sd-card-text">Reviewer: <a class="reference external" href="https://orcid.org/0000-0001-6513-9140">Jordi Cuadros</a></p></li>
<li><p class="sd-card-text">Topics: OPSIN API, Chemical identifiers, Chemical images, IUPAC compound names</p></li>
<li><p class="sd-card-text">Format: Interactive Jupyter Notebook (Python)</p></li>
<li><p class="sd-card-text">Scenarios: I need to access chemical identifiers an/or chemical images using code</p></li>
<li><p class="sd-card-text">Skills: You should be familiar with</p>
<ul>
<li><p class="sd-card-text"><a class="reference external" href="https://www.ibm.com/topics/api">Application Programming Interfaces (APIs)</a></p></li>
<li><p class="sd-card-text"><a class="reference external" href="https://iupac.qmul.ac.uk/BlueBook/">IUPAC Naming of Organic Compounds</a></p></li>
<li><p class="sd-card-text"><a class="reference external" href="https://chem.libretexts.org/Courses/University_of_Arkansas_Little_Rock/ChemInformatics_(2015)%3A_Chem_4399_5399/Text/5_Chemical_Identifiers">Chemical Identifiers</a></p></li>
</ul>
</li>
<li><p class="sd-card-text">Learning outcomes: After completing this example you should understand:</p>
<ul>
<li><p class="sd-card-text">How to write Python code to request data from a URL (typically an API)</p></li>
<li><p class="sd-card-text">How to use a Python variable to dynamically (with different values) call an API</p></li>
<li><p class="sd-card-text">How to access an image file from the OPSIN image API</p></li>
<li><p class="sd-card-text">How to use <a class="reference external" href="https://regexone.com/">regular expressions</a> (regex) to extract data from strings</p></li>
</ul>
</li>
<li><p class="sd-card-text">Citation: ‘Using the OPSIN API in Python’, The IUPAC FAIR Chemistry Cookbook, <a class="reference external" href="https://iupac.github.io/WFChemCookbook/samples/opsin.html">https://iupac.github.io/WFChemCookbook/samples/opsin.html</a></p></li>
<li><p class="sd-card-text">Reuse: This notebook is made available under a <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a> license.</p></li>
</ul>
</div>
</details><section id="about-opsin">
<h2>About OPSIN<a class="headerlink" href="#about-opsin" title="Permalink to this headline">#</a></h2>
<p>OPSIN is a web tool for converting an IUPAC systematic name into chemical identifiers, chemical markup language (CML) XML and images of molecules.  It is written in Java (GitHub repository) and accessed via a <a class="reference external" href="https://opsin.ch.cam.ac.uk">web form</a> (for humans), or its <a class="reference external" href="https://opsin.ch.cam.ac.uk/instructions.html">API</a> (for machines).  More information about OPSIN can be found here (<a class="reference external" href="https://opsin.ch.cam.ac.uk/information.html">website</a>) or here (<a class="reference external" href="https://pubs.acs.org/articlesonrequest/AOR-PcYgSy87ettZWfqyvHmN">paper</a>).</p>
</section>
<section id="step-1-import-the-python-packages">
<h2>Step 1: Import the Python packages<a class="headerlink" href="#step-1-import-the-python-packages" title="Permalink to this headline">#</a></h2>
<p>The following Python packages are installed in order to run the Python code.  Any package imported using ‘from’ is code developed by someone from the Python community (and typically made available to the community via <a class="reference external" href="https://pypi.org">pypi.org</a>), while a package imported starting with ‘import’ is native to Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>            <span class="c1"># package to run Python in a Jupyter notebook</span>
<span class="kn">import</span> <span class="nn">requests</span>                                       <span class="c1"># package to get data from a URL</span>
<span class="kn">import</span> <span class="nn">json</span>                                           <span class="c1"># package to read/write/display JSON</span>
<span class="kn">import</span> <span class="nn">re</span>                                             <span class="c1"># package to use regular expression (regex) searching</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-call-the-opsin-data-api">
<h2>Step 2: Call the OPSIN data API<a class="headerlink" href="#step-2-call-the-opsin-data-api" title="Permalink to this headline">#</a></h2>
<p>Calling an OPSIN API involves adding an IUPAC systematic name to the end of the base OPSIN API endpoint (see the path variable).
The format of the API request is ‘<a class="reference external" href="https://opsin.ch.cam.ac.uk/opsin/">https://opsin.ch.cam.ac.uk/opsin/</a>&lt;systematicname&gt;.json’.  This call returns data as in JSON format
even if the request does not work. If the request does not work the name provided is either no recognized or is not a systematic name.
In the example below, the ‘cml’ data in the JSON retrieved is removed to improve the display of the other data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;https://opsin.ch.cam.ac.uk/opsin/&quot;</span>            <span class="c1"># URL path to the OPSIN API</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;propan-2-one&quot;</span>                                 <span class="c1"># IUPAC name of a chemical compound, ion or element</span>
<span class="n">apiurl</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.json&#39;</span>                        <span class="c1"># concatenate (join) strings with the &#39;+&#39; operator</span>
<span class="n">reqdata</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">apiurl</span><span class="p">)</span>                        <span class="c1"># get is a method of request data from the OPSIN server</span>
<span class="n">jsondata</span> <span class="o">=</span> <span class="n">reqdata</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>                             <span class="c1"># get the downloaded JSON</span>
<span class="k">del</span> <span class="n">jsondata</span><span class="p">[</span><span class="s1">&#39;cml&#39;</span><span class="p">]</span>                                   <span class="c1"># remove the cml element of the JSON for nicer display</span>
<span class="nb">print</span><span class="p">(</span><span class="n">apiurl</span><span class="p">)</span>                                         <span class="c1"># print out the apiurl (useful as a check if an error is returned)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">jsondata</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>                 <span class="c1"># print the JSON in a nice format</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>https://opsin.ch.cam.ac.uk/opsin/propan-2-one.json
{
    &quot;status&quot;: &quot;SUCCESS&quot;,
    &quot;message&quot;: &quot;&quot;,
    &quot;inchi&quot;: &quot;InChI=1/C3H6O/c1-3(2)4/h1-2H3&quot;,
    &quot;stdinchi&quot;: &quot;InChI=1S/C3H6O/c1-3(2)4/h1-2H3&quot;,
    &quot;stdinchikey&quot;: &quot;CSCPPACGZOOCGX-UHFFFAOYSA-N&quot;,
    &quot;smiles&quot;: &quot;CC(C)=O&quot;
}
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-call-the-opsin-image-api">
<h2>Step 3: Call the OPSIN image API<a class="headerlink" href="#step-3-call-the-opsin-image-api" title="Permalink to this headline">#</a></h2>
<p>To request an image, rather than the JSON data (above), appending ‘.png’ (<a class="reference external" href="https://en.wikipedia.org/wiki/PNG">portable network graphic</a>) or ‘.svg’ (<a class="reference external" href="https://en.wikipedia.org/wiki/SVG">scaled vector graphics</a>) instead of ‘.json’ will send back and image of a molecule if the name can be interpretted. The format of the API request is ‘<a class="reference external" href="https://opsin.ch.cam.ac.uk/opsin/">https://opsin.ch.cam.ac.uk/opsin/</a>&lt;systematicname&gt;.png’ for a ‘.png’ file and ‘<a class="reference external" href="https://opsin.ch.cam.ac.uk/opsin/">https://opsin.ch.cam.ac.uk/opsin/</a>&lt;systematicname&gt;.svg’ for an ‘.svg’ file.</p>
<p><strong><em>NOTE</em></strong>: Other options for images can be found at the <a class="reference external" href="https://cactus.nci.nih.gov/chemical/structure">Chemical Identifier Resolver</a> from the US NIH, see this blog <a class="reference external" href="https://cactus.nci.nih.gov/blog/?p=136">https://cactus.nci.nih.gov/blog/?p=136</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reqimg</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span> <span class="c1"># request the image of the compound</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">reqimg</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>              <span class="c1"># display the image</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/opsin_7_0.png" src="../_images/opsin_7_0.png" />
</div>
</div>
</section>
<section id="step-4-extract-the-formula-of-the-substance">
<h2>Step 4: Extract the formula of the substance<a class="headerlink" href="#step-4-extract-the-formula-of-the-substance" title="Permalink to this headline">#</a></h2>
<p>An InChI string contains the molecular formula of the compound as part of the string.  Using regular expressions (formatted strings that match patterns in other text strings), also referred to as ‘regex’, you can find patterns in strings and extract them, or use them to create new strings.  Below, the ‘1S’ part of a standard InChI string is used to anchor a regular expression to match the molecular formula.  The string ‘(.+)’ means “match any character multiple times, in a sequence until you find a ‘)’ character. The ‘?’ is required to stop the regex from being ‘greedy’, matching the string all the way to the last ‘/’ in the InChI string, rather than stopping at the first, like we want.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The regular expression ‘1S/(.+?)/’ used below matches any characters between the first two forward slashes in an InChI string. Therefore, as ionic compounds
and salts of organics have their formula in the form ‘cation.anion’ (e.g., <a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/compound/6432248">ethylammonium nitrate</a> InChI=1S/C2H7N.NO3/c1-2-3;2-1(3)4/h2-3H2,1H3;/q;-1/p+1), which is not the normal format for a molecular formula.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;InchI: &#39;</span> <span class="o">+</span> <span class="n">jsondata</span><span class="p">[</span><span class="s1">&#39;stdinchi&#39;</span><span class="p">])</span>                 <span class="c1"># print the standard inchi</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;1S/(.+?)/&#39;</span><span class="p">,</span> <span class="n">jsondata</span><span class="p">[</span><span class="s1">&#39;stdinchi&#39;</span><span class="p">])</span>   <span class="c1"># match the formula using regex string</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Formula: &#39;</span> <span class="o">+</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>                           <span class="c1"># print the first (only) match</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>InchI: InChI=1S/C3H6O/c1-3(2)4/h1-2H3
Formula: C3H6O
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-try-other-queries">
<h2>Step 5: Try other queries<a class="headerlink" href="#step-5-try-other-queries" title="Permalink to this headline">#</a></h2>
<p>By changing the value of the ‘name’ variable in Step 2 and rerunning Steps 2, 3 and 4, you can retrieve data, get the image and formula for other molecules.  Try a molecule that is larger like ‘2-[3-[(4-amino-2-methylpyrimidin-5-yl)methyl]-4-methyl-1,3-thiazol-3-ium-5-yl]ethanol’.
If you delete (or comment out line 6 in the code of Step 2 by putting a ‘# ‘ in front of the code) you will also see the CML XML in the output.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./samples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="goldbook.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Accessing the IUPAC Gold Book API in Python</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="pubchem-pug.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PubChem PUG-REST API</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By IUPAC WorldFAIR Chemistry D3.2 Project<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>