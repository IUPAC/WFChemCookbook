

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Using the OPSIN API in Python &#8212; IUPAC FAIR Chemistry Cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/js/matomo.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tools/opsin_api_jn';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sources of FAIR Chemical Data" href="../data_sources.html" />
    <link rel="prev" title="OPSIN: Open Parser for Systematic IUPAC Nomenclature" href="opsin_api.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/iupac_and_wf.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/iupac_and_wf.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about_cookbook.html">About this Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use_cookbook.html">How to use the Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributions.html">Contributions to the Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feedback.html">Feedback on the Cookbook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The FAIR Chemistry Cookbook</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cooking.html">The Joy of Cooking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techniques.html">FAIR Techniques</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../tools.html">Tools &amp; Web Services</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="opsin_api.html">OPSIN: Open Parser for Systematic IUPAC Nomenclature</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Using the OPSIN API in Python</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../data_sources.html">Data Sources</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasources/goldbook_api.html">Accessing the IUPAC Gold Book API in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasources/pubchem.html">Data Repository: PubChem</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../datasources/pubchem_pugrest.html">PubChem PUG-REST API</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasources/pubchem_pugrest1.html">Accessing PubChem through PUG-REST - Part I</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datasources/pubchem_pugrest2.html">Accessing PubChem through PUG-REST: Part II</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datasources/pubchem_pugrest3.html">Accessing PubChem through PUG-REST: Part III</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manipulations.html">Data Manipulations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manipulations/computing_inchis.html">Computing InChIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manipulations/dataset_search.html">Finding a Findable Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manipulations/excel_import.html">Importing Chemical Data into a Spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manipulations/gsheets_citations.html">Importing JSON Citation Data from an API into Google Sheets</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../usecases.html">Use Cases &amp; Workflows</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../usecases/iupac_pkadata.html">Reuse of Curated Chemical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usecases/uvvis_metadata.html">Structured UV/Vis (meta)data for small molecule characterisation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about_project.html">About this project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/IUPAC/WFChemCookbook/main?urlpath=tree/book/tools/opsin_api_jn.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/IUPAC/WFChemCookbook/blob/main/book/tools/opsin_api_jn.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/IUPAC/WFChemCookbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/IUPAC/WFChemCookbook/issues/new?title=Issue%20on%20page%20%2Ftools/opsin_api_jn.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tools/opsin_api_jn.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Using the OPSIN API in Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-opsin">About OPSIN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-import-the-python-packages">Step 1: Import the Python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-call-the-opsin-data-api">Step 2: Call the OPSIN data API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-call-the-opsin-image-api">Step 3: Call the OPSIN image API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-extract-the-formula-of-the-substance">Step 4: Extract the formula of the substance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-try-other-queries">Step 5: Try other queries</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="using-the-opsin-api-in-python">
<h1>Using the OPSIN API in Python<a class="headerlink" href="#using-the-opsin-api-in-python" title="Permalink to this headline">#</a></h1>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
About this interactive <img alt="icons" src="../_images/rocket.png" /> recipe<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Author(s): <a class="reference external" href="https://orcid.org/0000-0002-0703-7776">Stuart Chalk</a></p></li>
<li><p class="sd-card-text">Reviewer(s): <a class="reference external" href="https://orcid.org/0000-0001-6513-9140">Jordi Cuadros</a></p></li>
<li><p class="sd-card-text">Topic(s): OPSIN API, Chemical identifiers, Chemical images, IUPAC compound names</p></li>
<li><p class="sd-card-text">Format(s): Interactive Jupyter Notebook (Python)</p></li>
<li><p class="sd-card-text">Scenario(s): I need to access chemical identifiers an/or chemical images using code</p></li>
<li><p class="sd-card-text">Skill(s): You should be familiar with</p>
<ul>
<li><p class="sd-card-text"><a class="reference external" href="https://www.ibm.com/topics/api">Application Programming Interfaces (APIs)</a></p></li>
<li><p class="sd-card-text"><a class="reference external" href="https://iupac.qmul.ac.uk/BlueBook/">IUPAC Naming of Organic Compounds</a></p></li>
<li><p class="sd-card-text"><a class="reference external" href="https://chem.libretexts.org/Courses/University_of_Arkansas_Little_Rock/ChemInformatics_(2015)%3A_Chem_4399_5399/Text/5_Chemical_Identifiers">Chemical Identifiers</a></p></li>
</ul>
</li>
<li><p class="sd-card-text">Learning outcomes: After completing this example you should understand:</p>
<ul>
<li><p class="sd-card-text">How to write Python code to request data from a URL (typically an API)</p></li>
<li><p class="sd-card-text">How to use a Python variable to dynamically (with different values) call an API</p></li>
<li><p class="sd-card-text">How to access an image file from the OPSIN image API</p></li>
<li><p class="sd-card-text">How to use <a class="reference external" href="https://regexone.com/">regular expressions</a> (regex) to extract data from strings</p></li>
</ul>
</li>
<li><p class="sd-card-text">Citation: We will not be providing citations for the sampler, but citations for recipes will be available (with copy button) in the full release of the Cookbook and will include DOI’s.</p></li>
<li><p class="sd-card-text">Reuse: This notebook is made available under a <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a> license.</p></li>
</ul>
</div>
</details><p>View this recipe in Binder!: <a class="reference external" href="https://mybinder.org/v2/gh/IUPAC/WFChemCookbook/main?urlpath=tree/book/samples/opsin.ipynb"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<section id="about-opsin">
<h2>About OPSIN<a class="headerlink" href="#about-opsin" title="Permalink to this headline">#</a></h2>
<p>OPSIN is a web tool for converting an IUPAC systematic name into chemical identifiers, chemical markup language (CML) XML and images of molecules.  It is written in Java (GitHub repository) and accessed via a <a class="reference external" href="https://opsin.ch.cam.ac.uk">web form</a> (for humans), or its <a class="reference external" href="https://opsin.ch.cam.ac.uk/instructions.html">API</a> (for machines).  More information about OPSIN can be found here (<a class="reference external" href="https://opsin.ch.cam.ac.uk/information.html">website</a>) or here (<a class="reference external" href="https://pubs.acs.org/articlesonrequest/AOR-PcYgSy87ettZWfqyvHmN">paper</a>).</p>
</section>
<section id="step-1-import-the-python-packages">
<h2>Step 1: Import the Python packages<a class="headerlink" href="#step-1-import-the-python-packages" title="Permalink to this headline">#</a></h2>
<p>The following Python packages are installed in order to run the Python code.  Any package imported using ‘from’ is code developed by someone from the Python community (and typically made available to the community via <a class="reference external" href="https://pypi.org">pypi.org</a>), while a package imported starting with ‘import’ is native to Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>            <span class="c1"># package to run Python in a Jupyter notebook</span>
<span class="kn">import</span> <span class="nn">requests</span>                                       <span class="c1"># package to get data from a URL</span>
<span class="kn">import</span> <span class="nn">json</span>                                           <span class="c1"># package to read/write/display JSON</span>
<span class="kn">import</span> <span class="nn">re</span>                                             <span class="c1"># package to use regular expression (regex) searching</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-call-the-opsin-data-api">
<h2>Step 2: Call the OPSIN data API<a class="headerlink" href="#step-2-call-the-opsin-data-api" title="Permalink to this headline">#</a></h2>
<p>Calling an OPSIN API involves adding an IUPAC systematic name to the end of the base OPSIN API endpoint (see the path variable).
The format of the API request is ‘https://opsin.ch.cam.ac.uk/opsin/&lt;systematicname&gt;.json’.  This call returns data as in JSON format
even if the request does not work. If the request does not work the name provided is either no recognized or is not a systematic name.
In the example below, the ‘cml’ data in the JSON retrieved is removed to improve the display of the other data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;https://opsin.ch.cam.ac.uk/opsin/&quot;</span>            <span class="c1"># URL path to the OPSIN API</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;propan-2-one&quot;</span>                                 <span class="c1"># IUPAC name of a chemical compound, ion or element</span>
<span class="n">apiurl</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.json&#39;</span>                        <span class="c1"># concatenate (join) strings with the &#39;+&#39; operator</span>
<span class="n">reqdata</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">apiurl</span><span class="p">)</span>                        <span class="c1"># get is a method of request data from the OPSIN server</span>
<span class="n">jsondata</span> <span class="o">=</span> <span class="n">reqdata</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>                             <span class="c1"># get the downloaded JSON</span>
<span class="k">del</span> <span class="n">jsondata</span><span class="p">[</span><span class="s1">&#39;cml&#39;</span><span class="p">]</span>                                   <span class="c1"># remove the cml element of the JSON for nicer display</span>
<span class="nb">print</span><span class="p">(</span><span class="n">apiurl</span><span class="p">)</span>                                         <span class="c1"># print out the apiurl (useful as a check if an error is returned)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">jsondata</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>                 <span class="c1"># print the JSON in a nice format</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>https://opsin.ch.cam.ac.uk/opsin/propan-2-one.json
{
    &quot;status&quot;: &quot;SUCCESS&quot;,
    &quot;message&quot;: &quot;&quot;,
    &quot;inchi&quot;: &quot;InChI=1/C3H6O/c1-3(2)4/h1-2H3&quot;,
    &quot;stdinchi&quot;: &quot;InChI=1S/C3H6O/c1-3(2)4/h1-2H3&quot;,
    &quot;stdinchikey&quot;: &quot;CSCPPACGZOOCGX-UHFFFAOYSA-N&quot;,
    &quot;smiles&quot;: &quot;CC(C)=O&quot;
}
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-call-the-opsin-image-api">
<h2>Step 3: Call the OPSIN image API<a class="headerlink" href="#step-3-call-the-opsin-image-api" title="Permalink to this headline">#</a></h2>
<p>To request an image, rather than the JSON data (above), appending ‘.png’ (<a class="reference external" href="https://en.wikipedia.org/wiki/PNG">portable network graphic</a>) or ‘.svg’ (<a class="reference external" href="https://en.wikipedia.org/wiki/SVG">scaled vector graphics</a>) instead of ‘.json’ will send back and image of a molecule if the name can be interpretted. The format of the API request is ‘https://opsin.ch.cam.ac.uk/opsin/&lt;systematicname&gt;.png’ for a ‘.png’ file and ‘https://opsin.ch.cam.ac.uk/opsin/&lt;systematicname&gt;.svg’ for an ‘.svg’ file.</p>
<p><strong><em>NOTE</em></strong>: Other options for images can be found at the <a class="reference external" href="https://cactus.nci.nih.gov/chemical/structure">Chemical Identifier Resolver</a> from the US NIH, see this blog <a class="reference external" href="https://cactus.nci.nih.gov/blog/?p=136">https://cactus.nci.nih.gov/blog/?p=136</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reqimg</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span> <span class="c1"># request the image of the compound</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">reqimg</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>              <span class="c1"># display the image</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/945ddf2113edede5fe534881338f5d02ff8874492377d263c66d8a987c08fddf.png" src="../_images/945ddf2113edede5fe534881338f5d02ff8874492377d263c66d8a987c08fddf.png" />
</div>
</div>
</section>
<section id="step-4-extract-the-formula-of-the-substance">
<h2>Step 4: Extract the formula of the substance<a class="headerlink" href="#step-4-extract-the-formula-of-the-substance" title="Permalink to this headline">#</a></h2>
<p>An InChI string contains the molecular formula of the compound as part of the string.  Using regular expressions (formatted strings that match patterns in other text strings), also referred to as ‘regex’, you can find patterns in strings and extract them, or use them to create new strings.  Below, the ‘1S’ part of a standard InChI string is used to anchor a regular expression to match the molecular formula (see note).  The string “(.+)” means ‘match any character multiple times, in a sequence until you find a ‘)’ character’. The ‘?’ is required to stop the regex from being ‘greedy’, matching the string all the way to the last ‘/’ in the InChI string, rather than stopping at the first, like we want.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For ionic compounds and salts of organics the InChI code adds their formula in the form ‘cation.anion’, e.g., <a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/compound/6432248">ethylammonium nitrate</a> InChI=1S/C2H7N.NO3/c1-2-3;2-1(3)4/h2-3H2,1H3;/q;-1/p+1).  This is not the normal format for a molecular formula, but you can generate one by totaling each element. Also note that the cation and anion formulae do not include the charges.  That is represented in the charge layer (q) at the end of the InChI.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;InchI: &#39;</span> <span class="o">+</span> <span class="n">jsondata</span><span class="p">[</span><span class="s1">&#39;stdinchi&#39;</span><span class="p">])</span>                 <span class="c1"># print the standard inchi</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;1S/(.+?)/&#39;</span><span class="p">,</span> <span class="n">jsondata</span><span class="p">[</span><span class="s1">&#39;stdinchi&#39;</span><span class="p">])</span>   <span class="c1"># match the formula using regex string</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Formula: &#39;</span> <span class="o">+</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>                           <span class="c1"># print the first (only) match</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>InchI: InChI=1S/C3H6O/c1-3(2)4/h1-2H3
Formula: C3H6O
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-try-other-queries">
<h2>Step 5: Try other queries<a class="headerlink" href="#step-5-try-other-queries" title="Permalink to this headline">#</a></h2>
<p>By changing the value of the ‘name’ variable in Step 2 and rerunning Steps 2, 3 and 4, you can retrieve data, get the image and formula for other molecules.  Try a molecule that is larger like ‘2-[3-[(4-amino-2-methylpyrimidin-5-yl)methyl]-4-methyl-1,3-thiazol-3-ium-5-yl]ethanol’.
If you delete (or comment out line 6 in the code of Step 2 by putting a ‘# ‘ in front of the code) you will also see the CML XML in the output.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tools"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="opsin_api.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">OPSIN: Open Parser for Systematic IUPAC Nomenclature</p>
      </div>
    </a>
    <a class="right-next"
       href="../data_sources.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sources of FAIR Chemical Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-opsin">About OPSIN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-import-the-python-packages">Step 1: Import the Python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-call-the-opsin-data-api">Step 2: Call the OPSIN data API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-call-the-opsin-image-api">Step 3: Call the OPSIN image API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-extract-the-formula-of-the-substance">Step 4: Extract the formula of the substance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-try-other-queries">Step 5: Try other queries</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By IUPAC WorldFAIR Chemistry D3.2 Project
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Licenses:  See the "About this..." section in a page for the per resource license. Default license is <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>.<br/>
<em>WorldFAIR “Global cooperation on FAIR data policy and practice” is funded by the EC HORIZON-WIDERA-2021-ERA-01-41<br/>
Coordination and Support Action under Grant Agreement No. 101058393.</em>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>