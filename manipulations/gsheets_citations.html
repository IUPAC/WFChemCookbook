

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Importing JSON Citation Data from an API into Google Sheets &#8212; IUPAC FAIR Chemistry Cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/js/matomo.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'manipulations/gsheets_citations';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using InChI and InChIKey to annotate your chemical entities" href="using_inchi.html" />
    <link rel="prev" title="Importing Chemical Data into Excel" href="excel_import.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/iupac_and_wf.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/iupac_and_wf.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about_cookbook.html">About this Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use_cookbook.html">How to use the Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributions.html">Contribute to the Cookbook!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feedback.html">Feedback on the Cookbook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The FAIR Chemistry Cookbook</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../cooking.html">The Joy of FAIR</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../techniques.html">FAIR Techniques</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tools.html">Tools &amp; Web Services</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/opsin_api.html">OPSIN: Open Parser for Systematic IUPAC Nomenclature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/opsin_api_jn.html">Using the OPSIN API in Python</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../data_sources.html">Data Sources</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasources/goldbook_api.html">Terminology: The IUPAC Gold Book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasources/cas_commonchem.html">CAS Common Chemistry API</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../datasources/pubchem.html">Data Repository: PubChem</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../datasources/pubchem_pugrest.html">PubChem PUG-REST</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../datasources/pubchem_pugrest1.html">Accessing PubChem through PUG-REST - Part I</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasources/pubchem_pugrest2.html">Accessing PubChem through PUG-REST: Part II</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasources/pubchem_pugrest3.html">Accessing PubChem through PUG-REST: Part III</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../datasources/pubchem_pugview.html">PubChem PUG-View</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datasources/pubchem_ptable.html">PubChem Periodic Table</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../manipulations.html">Data Manipulations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="computing_inchis.html">Computing InChIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataset_search.html">Finding a Findable Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="excel_import.html">Importing data into Excel</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Importing data into Google Sheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_inchi.html">Annotation with InChIs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../usecases.html">Use Cases &amp; Workflows</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../usecases/iupac_pkadata.html">Reuse of Curated Chemical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usecases/uvvis_metadata.html">Structured UV/Vis (meta)data for small molecule characterisation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../about_project.html">About this project</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributors.html">Project Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html">Cookbook development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worldfair.html">WordFAIR Chemistry</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/IUPAC/WFChemCookbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/IUPAC/WFChemCookbook/issues/new?title=Issue%20on%20page%20%2Fmanipulations/gsheets_citations.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/manipulations/gsheets_citations.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Importing JSON Citation Data from an API into Google Sheets</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-the-crossref-api">1 Accessing the CrossRef API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-and-formatting-the-citation-string">2 Getting and formatting the citation string</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">3 Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="importing-json-citation-data-from-an-api-into-google-sheets">
<h1>Importing JSON Citation Data from an API into Google Sheets<a class="headerlink" href="#importing-json-citation-data-from-an-api-into-google-sheets" title="Permalink to this headline">#</a></h1>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
About this recipe<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Author: <a class="reference external" href="https://orcid.org/0000-0001-6513-9140">Stuart Chalk</a></p></li>
<li><p class="sd-card-text">Topics: Data Importing, Google Sheets, Citation data</p></li>
<li><p class="sd-card-text">Format: Markdown file, Google Sheets file</p></li>
<li><p class="sd-card-text">Skills: You should be familiar with</p>
<ul>
<li><p class="sd-card-text"><a class="reference external" href="https://www.youtube.com/watch?v=FIkZ1sPmKNw&amp;t=12s">Google Sheets</a></p></li>
<li><p class="sd-card-text"><a class="reference external" href="https://www.youtube.com/watch?v=iiADhChRriM">JSON</a></p></li>
<li><p class="sd-card-text"><a class="reference external" href="https://api.crossref.org">Crossref API</a></p></li>
</ul>
</li>
<li><p class="sd-card-text">Learning outcomes:  After completing this example you should understand:</p>
<ul>
<li><p class="sd-card-text">Options to import data into Google Sheets</p></li>
<li><p class="sd-card-text">Understand how to configure the Google Sheets document to import .json files</p></li>
<li><p class="sd-card-text">Usage of the ImportJSON Apps Script</p></li>
</ul>
</li>
<li><p class="sd-card-text">Citation: ‘Importing JSON Citation Data from an API into Google Sheets’, Stuart Chalk, The IUPAC FAIR Chemistry Cookbook,
Contributed: 2024-02-14 <a class="reference external" href="https://w3id.org/ifcc/IFCC015">https://w3id.org/ifcc/IFCC015</a>.</p></li>
<li><p class="sd-card-text">Reuse: This notebook is made available under a <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a> license.</p></li>
</ul>
</div>
</details><section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>In many research contexts, access to the literature is very important and dealing with its metadata can be time-consuming.
The advent of the <a class="reference external" href="https://www.doi.org/">Digital Object Identifier</a> (DOI) has made it much easier to deal with
citation data for many different types of digital resources.  Currently, twelve <a class="reference external" href="https://www.doi.org/the-community/existing-registration-agencies/">registration agencies</a> are
‘minting’ (creating) DOI’s and each has a different scope and size.  From a research literature perspective
<a class="reference external" href="https://www.crossref.org/">CrossRef</a> is the agency  that holds DOI’s (now <a class="reference external" href="https://www.crossref.org/06members/53status.html">~150,000,000</a>) and that is a lot of data to sort through.</p>
<p>This tutorial therefore focuses on understanding how you can pull in citation metadata from the CrossRef API, and
load it in a Google Sheet, to make it easy (for instance) to create a citation string for a paper.  An example of a
sheet that does this is available <a class="reference external" href="https://docs.google.com/spreadsheets/d/1tvU1p4zZBHgiAl1IFZHerh7_yqrn_Vn5nLIV9FcAz_0/edit#gid=0">here</a>,
and you can make a copy and play around with it. Exploring what it takes to put the data into the document is a great
way to understand the CrossRef schema, the structure of how the data is provided.</p>
</section>
<section id="accessing-the-crossref-api">
<h2>1 Accessing the CrossRef API<a class="headerlink" href="#accessing-the-crossref-api" title="Permalink to this headline">#</a></h2>
<p>The CrossRef API makes metadata available about journal papers, books and other publication types.  Detailed documentation
of the API is available at main URL endpoint, https://api.crossref.org.  This is too big to go over in this tutorial, so
we will just be focusing on the ‘works’ endpoint (a partial URL that you can add a DOI to) - in this case
https://api.crossref.org/works/.  If you append a DOI to this partial URL and put it in a browser you will
get a JSON file returned (see below).  The JSON file in the image is formatted using the <a class="reference external" href="https://jsonview.com/">JSONView</a>
plugin for Firefox and all the fields have been collapsed to make it easy to see the whole file at
http://api.crossref.org/works/10.1515/pac-2018-1010.</p>
<p><img alt="fig" src="../_images/gsheets_citations_crossref_api.jpg" />
Caption: JSON output from the Crossref API</p>
<p>The data we need to extract to be able to create a citation for this paper is spread throughoout different parts of the
JSON file, so we need to know how to get to these metadata elements. You can think about accessing information in the
JSON file by using the concept of ‘paths’ to the data elements (just like accessing files in a computer). In this case
the data we need are at the following paths:</p>
<ul class="simple">
<li><p><strong>title</strong>: /message/title</p></li>
<li><p><strong>author last names</strong>: /message/author/given (for each author)</p></li>
<li><p><strong>author first names</strong>: /message/author/family (for each author)</p></li>
<li><p><strong>journal</strong>: /message/container-title
(alternatively if you want the journal abbreviation you can use /message/short-container-title if available)</p></li>
<li><p><strong>year</strong>: /message/published/date-parts (index 0 in the JSON array)</p></li>
<li><p><strong>volume</strong>: /message/volume</p></li>
<li><p><strong>issue</strong>: /message/issue</p></li>
<li><p><strong>pages</strong>: /message/page (yes singular)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Looking at this you will see that while the data is available, it is not as logically organized as it could be and
there are some formatting issues (for instance the abstract).  This is a consequence of both the CrossRef schema for
the JSON output, and the approach to populating the metadata of the publisher.  With the focus on open citations in
the research community I hope that this will soon be addressed.</p>
</div>
</section>
<section id="getting-and-formatting-the-citation-string">
<h2>2 Getting and formatting the citation string<a class="headerlink" href="#getting-and-formatting-the-citation-string" title="Permalink to this headline">#</a></h2>
<p>In order to create our citation string on the Google sheet we need to implement a call to the CrossRef URL, for the
paper retrieval of these metadata fields and some organization and formating. This is implemented in the Google sheet
in each column, and much of the mechanics is hidden in rows between the showing data.  This is all explained in the
‘How it works’ sheet.</p>
<p><img alt="fig" src="../_images/gsheets_citations_howitworks.jpg" />
Caption: The Google Sheets ‘How It Works’ sheet</p>
<p>Let’s walk through the code.  The Crossref path is in cell B2 and the DOI is added to cell B3.  The full path is
created in the Google Sheet function ‘CONCAT’.  Here is an example call to get the data.</p>
<p><code class="docutils literal notranslate"><span class="pre">=ImportJSON(CONCATENATE('How</span> <span class="pre">it</span> <span class="pre">works'!$B$2,B3),</span> <span class="pre">&quot;/message/title&quot;,</span> <span class="pre">&quot;noInherit,noTruncate,rawHeaders&quot;)</span></code></p>
<p>The Google Sheet ‘ImportJSON’ addon <a class="reference external" href="https://workspace.google.com/marketplace/app/importjson_import_json_data_into_google/782573720506">function</a>
takes a URL (first variable) and a path to data (second variable) and optionally
some processing options (third variable).  When the Google sheet processes this function the data at the path is put into
the cell below the function.  This works easily for the title, journal name, volume, issue and pages.</p>
<p>In order to process the authors and the year we have to do a little more.  For the authors, the data is a JSON array
and thus has to be organized to subsequently be able to be put back together as a string.  This is done by loading the
data (up to eight authors) into columns B and C, concatenating these in column D and finally concatenating non-empty
cells in B15.  This can be expanded to more authors by adding more space for authors and updating the code to cover
all the author data.</p>
<p>For the year, as there is no ‘year’ field, we need to take the publised data parts (year, month, day) as a comma
separated string (B19) and then get the first four characters of that string to get the year.  It would be easier if the
‘path’ could point to specific elements in the array (i.e. /message/published/date-parts/0), but this does not work.</p>
<p>Finally, our goal of a citation string is implemented in B27, by concatenating the fields above with some extra
formatting.  In the ‘Worksheet’ sheet, all the mechanics are hidden and all that is needed is to add a DOI of a
paper in each/any of B2, C2, or D2 (you can copy any of the B, C or D columns across to other columns to process)
metadata for more files.</p>
</section>
<section id="conclusion">
<h2>3 Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
<p>In this brief tutorial you can see how Google Sheets and the ImportJSON addon allows you to process any API data.
Given this example, you can create spreadsheet views of API data, and even integrate data from multiple sources.
The only thing to be aware of is that the more calls to APIs that you make in one sheet, the slower the over all
sheet will work, but this of course depends on your access speed, so you may need to optimize how you import the data.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./manipulations"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="excel_import.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Importing Chemical Data into Excel</p>
      </div>
    </a>
    <a class="right-next"
       href="using_inchi.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using InChI and InChIKey to annotate your chemical entities</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-the-crossref-api">1 Accessing the CrossRef API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-and-formatting-the-citation-string">2 Getting and formatting the citation string</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">3 Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By IUPAC WorldFAIR Chemistry D3.2 Project
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Licenses:  See the "About this..." section in a page for the per resource license. Default license is <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>.<br/>
<img alt="EU funded" src="https://iupac.github.io/WFChemCookbook/_static/img/eu_funded.jpg" width="200"/><br/>
WorldFAIR “Global cooperation on FAIR data policy and practice” is funded by the EC HORIZON-WIDERA-2021-ERA-01-41<br/>
Coordination and Support Action under Grant Agreement No. 101058393.

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>